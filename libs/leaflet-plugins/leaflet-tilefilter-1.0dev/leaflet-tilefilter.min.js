/*! leaflet-tilefilter 07-08-2015 */
/*
 @preserve Leaflet Tile Filters, a JavaScript plugin for applying image filters to tile images
 (c) 2014, Scott Fairgrieve, HumanGeo
*/
L.Browser.littleEndian=function(){var a=new ArrayBuffer(2);return new DataView(a).setInt16(0,256,!0),256===new Int16Array(a)[0]}(),L.Color=L.Class.extend({statics:{ONE_SIXTH:1/6,ONE_THIRD:1/3,TWO_THIRDS:2/3,HALF:.5},initialize:function(a){this._rgb=[0,0,0],this._hsl=[0,1,.5],this._a=1,a&&this.parseColorDef(a)},parseColorDef:function(a){},rgbToHSL:function(a,b,c){a/=255,b/=255,c/=255;var d,e,f=Math.max(a,b,c),g=Math.min(a,b,c),h=(f+g)/2;if(f==g)d=e=0;else{var i=f-g;switch(e=h>.5?i/(2-f-g):i/(f+g),f){case a:d=(b-c)/i+(c>b?6:0);break;case b:d=(c-a)/i+2;break;case c:d=(a-b)/i+4}d/=6}return[d,e,h]},hue2rgb:function(a,b,c){return 0>c&&(c+=1),c>1&&(c-=1),c<L.Color.ONE_SIXTH?a+6*(b-a)*c:c<L.Color.HALF?b:c<L.Color.TWO_THIRDS?a+(b-a)*(L.Color.TWO_THIRDS-c)*6:a},hslToRGB:function(a,b,c){var d,e,f;if(0===b)d=e=f=c;else{var g=.5>c?c*(1+b):c+b-c*b,h=2*c-g;d=this.hue2rgb(h,g,a+L.Color.ONE_THIRD),e=this.hue2rgb(h,g,a),f=this.hue2rgb(h,g,a-L.Color.ONE_THIRD)}return[Math.floor(255*d),Math.floor(255*e),Math.floor(255*f)]},setRGB:function(a,b,c){return this._rgb=[a,b,c],this._hsl=this.rgbToHSL(a,b,c),this},setHSL:function(a,b,c){return this._hsl=[a,b,c],this._rgb=this.hslToRGB(a,b,c),this},toHSL:function(){return this._hsl},toHSLString:function(){var a="hsl";return this._a<1&&(a+="a"),a+"("+(360*this._hsl[0]).toFixed(1)+","+(100*this._hsl[1]).toFixed(0)+"%,"+(100*this._hsl[2]).toFixed(0)+"%)"},toRGB:function(){return this._rgb},toRGBString:function(){var a;if(this._a<1)a="rgba("+this._rgb[0].toFixed(0)+","+this._rgb[1].toFixed(0)+","+this._rgb[2].toFixed(0)+","+this._a.toFixed(1)+")";else{for(var b=[this._rgb[0].toString(16),this._rgb[1].toString(16),this._rgb[2].toString(16)],c=0,d=b.length;d>c;++c)1===b[c].length&&(b[c]="0"+b[c]);a="#"+b.join("")}return a},toInt:function(){var a;return a=L.Browser.littleEndian?this._a<<24|this._rgb[2]<<16|this._rgb[1]<<8|this._rgb[0]:this._rgb[0]<<24|this._rgb[1]<<16|this._rgb[2]<<8|this._a},r:function(a){return arguments.length?this.setRGB(a,this._rgb[1],this._rgb[2]):this._rgb[0]},g:function(a){return arguments.length?this.setRGB(this._rgb[0],a,this._rgb[2]):this._rgb[1]},b:function(a){return arguments.length?this.setRGB(this._rgb[0],this._rgb[1],a):this._rgb[2]},h:function(a){return arguments.length?this.setHSL(a,this._hsl[1],this._hsl[2]):this._hsl[0]},s:function(a){return arguments.length?this.setHSL(this._hsl[0],a,this._hsl[2]):this._hsl[1]},l:function(a){return arguments.length?this.setHSL(this._hsl[0],this._hsl[1],a):this._hsl[2]},a:function(a){return arguments.length?(this._a=a,this):this._a}}),L.Color32=L.Class.extend({statics:{ONE_SIXTH:1/6,ONE_THIRD:1/3,TWO_THIRDS:2/3,HALF:.5},initialize:function(a,b){L.Browser.littleEndian?(this._r=a>>0&255,this._g=a>>8&255,this._b=a>>16&255,this._a=a>>24&255):(this._r=a>>24&255,this._g=a>>16&255,this._b=a>>8&255,this._a=a>>0&255),b&&this.rgb2hsl()},r:function(a,b){return arguments.length?(this._r=Math.min(a,255),b&&this.rgb2hsl(),this):this._r},g:function(a,b){return arguments.length?(this._g=Math.min(a,255),b&&this.rgb2hsl(),this):this._g},b:function(a,b){return arguments.length?(this._b=Math.min(a,255),b&&this.rgb2hsl(),this):this._b},a:function(a,b){return arguments.length?(this._a=Math.min(a,255),this):this._a},h:function(a,b){return arguments.length?(this._h=a,b&&this.hsl2rgb(),this):this._h},s:function(a,b){return arguments.length?(this._s=a,b&&this.hsl2rgb(),this):this._s},l:function(a,b){return arguments.length?(this._l=a,b&&this.hsl2rgb(),this):this._l},hue2rgb:function(a,b,c){return 0>c&&(c+=1),c>1&&(c-=1),c<L.Color32.ONE_SIXTH?a+6*(b-a)*c:c<L.Color32.HALF?b:c<L.Color32.TWO_THIRDS?a+(b-a)*(L.Color32.TWO_THIRDS-c)*6:a},rgb2hsl:function(){var a=this._r,b=this._g,c=this._b;a/=255,b/=255,c/=255;var d,e,f=Math.max(a,b,c),g=Math.min(a,b,c),h=(f+g)/2;if(f===g)d=e=0;else{var i=f-g;switch(e=h>.5?i/(2-f-g):i/(f+g),f){case a:d=(b-c)/i+(c>b?6:0);break;case b:d=(c-a)/i+2;break;case c:d=(a-b)/i+4}d/=6}this._h=d,this._s=e,this._l=h},setHSL:function(a,b,c){return this._h=a,this._s=b,this._l=c,this.hsl2rgb(),this},setRGB:function(a,b,c,d){return this._r=a,this._g=b,this._b=c,d&&this.rgb2hsl(),this},hsl2rgb:function(){var a,b,c;if(0===this._s)a=b=c=this._l;else{var d=this._l<.5?this._l*(1+this._s):this._l+this._s-this._l*this._s,e=2*this._l-d;a=this.hue2rgb(e,d,this._h+L.Color32.ONE_THIRD),b=this.hue2rgb(e,d,this._h),c=this.hue2rgb(e,d,this._h-L.Color32.ONE_THIRD)}this._r=Math.floor(255*a),this._g=Math.floor(255*b),this._b=Math.floor(255*c)},toInt:function(){var a;return a=L.Browser.littleEndian?this._a<<24|this._b<<16|this._g<<8|this._r:this._r<<24|this._g<<16|this._b<<8|this._a},toColor:function(){return new L.RGBColor([this._r,this._g,this._b,this._a])}}),L.RGBColor=L.Color.extend({initialize:function(a){L.Color.prototype.initialize.call(this,a)},parseColorDef:function(a){var b,c,d,e,f="number"==typeof a,g=a instanceof Array,h=f||g?!1:0===a.indexOf("#"),i=[];f||(g?(b=Math.floor(a[0]),c=Math.floor(a[1]),d=Math.floor(a[2]),e=4===a.length?a[3]:1):h?(a=a.replace("#",""),b=parseInt(a.substring(0,2),16),c=parseInt(a.substring(2,4),16),d=parseInt(a.substring(4,6),16),e=8===a.length?parseInt(a.substring(6,8),16):1):(i=a.replace("rgb","").replace("a","").replace(/\s+/g,"").replace("(","").replace(")","").split(","),b=parseInt(i[0]),c=parseInt(i[1]),d=parseInt(i[2]),e=4===i.length?parseInt(i[3]):1)),this.setRGB(b,c,d),this._a=e}}),L.rgbColor=function(a){return new L.RGBColor(a)},L.ImageFilter=L.Class.extend({initialize:function(a){L.Util.setOptions(this,a)},render:function(a,b,c){return this}}),L.CanvasFilter=L.ImageFilter.extend({render:function(a,b,c){var d,e=L.Browser.retina?2:1,f=b.options.tileSize*e,g=!0;if(c||(g=!1,d=document.createElement("canvas"),d.width=d.height=f,c=d.getContext("2d")),c){var h=this.options.channelFilter||function(a){return a};c.drawImage(b,0,0);var i=c.getImageData(0,0,f,f);i=h.call(b,i,c),c.putImageData(i,0,0),g||(b.onload=null,b.removeAttribute("crossorigin"),b.options.canvasFilter?b.options.canvasFilter.call(this,b,c):b.src=d.toDataURL())}return this}}),L.ChannelFilters={},L.ConvolveFilter=L.Class.extend({options:{weights:[0,-1,0,-1,5,-1,0,-1,0],opaque:!1},initialize:function(a){L.Util.setOptions(this,a)},render:function(a,b){for(var c=a.data,d=this.options.weights,e=Math.round(Math.sqrt(d.length)),f=Math.floor(e/2),g=this.options.opaque?1:0,h=a.height,i=a.width,j=i,k=h,l=b.createImageData(j,k),m=l.data,n=0;k>n;n++)for(var o=0;j>o;o++){for(var p=n,q=o,r=4*(n*j+o),s=0,t=0,u=0,v=0,w=0;e>w;w++)for(var x=0;e>x;x++){var y=Math.min(h-1,Math.max(0,p+w-f)),z=Math.min(i-1,Math.max(0,q+x-f)),A=4*(y*i+z),B=d[w*e+x];s+=c[A]*B,t+=c[A+1]*B,u+=c[A+2]*B,v+=c[A+3]*B}m[r]=s,m[r+1]=t,m[r+2]=u,m[r+3]=v+g*(255-v)}return l}}),L.AlphaChannelFilter=L.Class.extend({statics:{RENDER_MODE_CHANNELS:function(a){for(var b=a.data,c=0,d=b.length;d>c;c+=4)for(var e=this.updateChannels([b[c],b[c+1],b[c+2],b[c+3]]),f=0;4>f;++f)b[c+f]=e[f];return a},RENDER_MODE_PIXEL:function(a){for(var b=new Uint32Array(a.data.buffer),c=0,d=b.length;d>c;++c)b[c]=this.updatePixel(b[c]);return a}}}),L.AlphaChannelFilter=L.AlphaChannelFilter.extend({options:{opacity:255,renderMode:L.AlphaChannelFilter.RENDER_MODE_PIXEL},initialize:function(a){L.setOptions(this,a)},setOpacity:function(a){this.options.opacity=a},updateChannels:function(a){return a[3]=this.options.opacity,a},updatePixel:function(a){var b=new L.Color32(a);return b.a(this.options.opacity),b.toInt()},render:function(a){return this.options.renderMode.call(this,a)}}),L.CanvasChannelFilter=L.AlphaChannelFilter.extend({options:{filters:[]},setFilters:function(a){return this.options.filters=a,this},clearFilters:function(){return this.options.filters=[],this},updateChannels:function(a){a=L.AlphaChannelFilter.prototype.updateChannels.call(this,a);for(var b=this.options.filters,c=0,d=b.length;d>c;++c)a=b[c].updateChannels(a);return a},updatePixel:function(a){for(var b=this.options.filters,c=0,d=b.length;d>c;++c)a=b[c].updatePixel(a);return a}}),L.ChannelFilter=L.Class.extend({initialize:function(a){L.setOptions(this,a),this._keys=["r","g","b","a"]},updateChannels:function(a){return a},updatePixel:function(a){return a}}),L.ChannelFilters.Grayscale=L.ChannelFilter.extend({options:{channelWeights:[3,4,1]},initialize:function(a){L.ChannelFilter.prototype.initialize.call(this,a),this.sumWeights()},sumWeights:function(){for(var a=0,b=0;3>b;++b)a+=this.options.channelWeights[b];this._summedWeight=a},updateChannels:function(a){var b=this.options.channelWeights;return a[0]=a[1]=a[2]=(b[0]*a[0]+b[1]*a[1]+b[2]*a[2])/this._summedWeight,a},updatePixel:function(a){var b=new L.Color32(a),c=this.options.channelWeights,d=(c[0]*b._r+c[1]*b._g+c[2]*b._b)/this._summedWeight;return b.setRGB(d,d,d),b.toInt()}}),L.ChannelFilters.Threshold=L.ChannelFilters.Grayscale.extend({options:{channelWeights:[3,4,1],thresholds:[128,128,128,128],trueValues:[255,255,255,255],falseValues:[0,0,0,255]},updateChannels:function(a){a=L.ChannelFilters.Grayscale.prototype.updateChannels.call(this,a);for(var b=0;4>b;++b)a[b]=a[b]>=this.options.thresholds[b]?this.options.trueValues[b]:this.options.falseValues[b];return a},updatePixel:function(a){var b=new L.Color32(a);return b.setRGB(b._r>=this.options.thresholds[0]?this.options.trueValues[0]:this.options.falseValues[0],b._g>=this.options.thresholds[1]?this.options.trueValues[1]:this.options.falseValues[1],b._b>=this.options.thresholds[2]?this.options.trueValues[2]:this.options.falseValues[2]),b.toInt()}}),L.ChannelFilters.Contrast=L.ChannelFilter.extend({options:{contrast:0,factor:function(a){return 255*(255+a)/(255*(255-a))}},initialize:function(a){L.ChannelFilter.prototype.initialize.call(this,a),this._factor=this.options.factor.call(this,this.options.contrast)},updateChannels:function(a){for(var b=0;3>b;++b)a[b]=this._factor*(a[b]-128)+128;return a},updatePixel:function(a){for(var b=new L.Color32(a),c=0;3>c;++c)b[this._keys[c]](this._factor*(b[this._keys[c]]()-128)+128);return b.toInt()}}),L.ChannelFilters.Invert=L.ChannelFilter.extend({updateChannels:function(a){for(var b=0;3>b;++b)a[b]=255-a[b];return a},updatePixel:function(a){for(var b=new L.Color32(a),c=0;3>c;++c)b["_"+this._keys[c]]=255-b["_"+this._keys[c]];return b.toInt()}}),L.ChannelFilters.ChannelSwap=L.ChannelFilter.extend({options:{positions:[0,1]},updateChannels:function(a){var b=a[this.options.positions[0]];return a[this.options.positions[0]]=a[this.options.positions[1]],a[this.options.positions[1]]=b,a},updatePixel:function(a){var b=new L.Color32(a),c=b[this._keys[this.options.positions[0]]]();return b[this._keys[this.options.positions[0]]](b[this._keys[this.options.positions[1]]]()),b[this._keys[this.options.positions[1]]](c),b.toInt()}}),L.ChannelFilters.Matrix=L.ChannelFilter.extend({options:{matrix:[.393,.769,.189,.349,.686,.168,.272,.534,.131]},initialize:function(a){L.ChannelFilter.prototype.initialize.call(this,a)},updateChannels:function(a){for(var b=this.options.matrix,c=a[0],d=a[1],e=a[2],f=0;3>f;++f)a[f]=c*b[3*f]+d*b[3*f+1]+e*b[3*f+2];return a},updatePixel:function(a){for(var b=this.options.matrix,c=new L.Color32(a),d=c._r,e=c._g,f=c._b,g=0;3>g;++g)c["_"+this._keys[g]]=Math.min(255,Math.floor(d*b[3*g]+e*b[3*g+1]+f*b[3*g+2]));return c.toInt()}}),L.ChannelFilters.Sepia=L.ChannelFilters.Matrix.extend({options:{matrix:[.393,.769,.189,.349,.686,.168,.272,.534,.131]}}),L.ChannelFilters.Adjust=L.ChannelFilter.extend({options:{adjustments:[20,20,20]},updateChannels:function(a){for(var b=0;3>b;++b)a[b]=Math.min(Math.max(a[b]+this.options.adjustments[b],0),255);return a},updatePixel:function(a){for(var b=new L.Color32(a),c=0,d=this._keys.length;d>c;++c)b[this._keys[c]](Math.min(Math.max(b[this._keys[c]]()+this.options.adjustments[c],0),255));return b.toInt()}}),L.ChannelFilters.HSLAdjust=L.ChannelFilter.extend({options:{adjustments:[30,0,0]},updateChannels:function(a){var b=new L.RGBColor([a[0],a[1],a[2],a[3]]);b.setHSL((360*b._hsl[0]+this.options.adjustments[0])/360,b._hsl[1]+this.options.adjustments[1],b._hsl[2]+this.options.adjustments[2]);for(var c=0;3>c;++c)a[c]=b._rgb[c];return this.options.adjustments.length>3&&(a[3]+=this.options.adjustments[3]),b=null,a},updatePixel:function(a){var b=new L.Color32(a,!0);return b.setHSL((360*b._h+this.options.adjustments[0])/360,b._s+this.options.adjustments[1],b._l+this.options.adjustments[2]),this.options.adjustments.length>3&&b.a(b.a()+this.options.adjustments[3]),b.toInt()}}),L.ChannelFilters.Colorize=L.ChannelFilter.extend({options:{channel:0,values:[0,0]},updateChannels:function(a){var b=[0,1,2];b.splice(this.options.channel,1);var c=a[0],d=a[1],e=a[2];return a[this.options.channel]=(c+d+e)/3,a[b[0]]=this.options.values[0],a[b[1]]=this.options.values[1],a},updatePixel:function(a){var b=[0,1,2];b.splice(this.options.channel,1);var c=new L.Color32(a);return c[this._keys[this.options.channel]]((c.r()+c.g()+c.b())/3),c[this._keys[b[0]]](this.options.values[0]),c[this._keys[b[1]]](this.options.values[1]),c.toInt()}}),L.ChannelFilters.MatchAndTransform=L.ChannelFilter.extend({options:{match:function(a){return!0},matching:function(a){return a},nomatching:function(a){return a}},updateChannels:function(a){var b=new L.RGBColor([a[0],a[1],a[2],a[3]]),c=this.options.match.call(this,b);c?this.options.matching&&(b=this.options.matching.call(this,b)):this.options.nonmatching&&(b=this.options.nonmatching.call(this,b));for(var d=0;3>d;++d)a[d]=b._rgb[d];return a[3]=255*b._a,b=null,a},updatePixel:function(a){var b=new L.Color32(a),c=b.toColor(),d=this.options.match.call(this,c);d?this.options.matching&&(c=this.options.matching.call(this,c)):this.options.nonmatching&&(c=this.options.nonmatching.call(this,c));for(var e=0;3>e;++e)b[this._keys[e]](c._rgb[e]);return b.a(255*c._a),b.toInt()}}),L.ChannelFilters.ColorSwap=L.ChannelFilters.MatchAndTransform.extend({options:{input:{h:[150,200],s:[0,1],l:[0,1]},output:{h:0},match:function(a){var b=!1;for(var c in this.options.input){var d=this.options.input[c],e=a[c].call(a);if("h"===c&&(e=360*e),b=e>=d[0]&&e<=d[1],!b)break}return b},matching:function(a){for(var b in this.options.output){var c=this.options.output[b];"h"===b&&(c/=360),a[b].call(a,c)}return a},nonmatching:function(a){return a}}}),L.CSSFilter=L.ImageFilter.extend({statics:{prefixes:["-webkit-","-moz-","-ms-","-o-",""]},render:function(a,b,c){for(var d=0,e=L.CSSFilter.prefixes.length;e>d;++d)a.style.cssText+=" "+L.CSSFilter.prefixes[d]+"filter: "+this.options.filters.join(" ")+";"}}),L.CombinedFilter=L.ImageFilter.extend({setCanvasFilter:function(a){return this.options.canvasFilter=a,this},setCSSFilter:function(a){return this.options.cssFilter=a,this},renderCanvas:function(a,b,c){return this.options.canvasFilter&&this.options.canvasFilter.call(a,a,b,c),this},renderCSS:function(a,b,c){return this.options.cssFilter&&this.options.cssFilter.call(a,a,b,c),this},render:function(a,b,c){return this.renderCanvas(a,b,c),this.renderCSS(a,b,c),this}}),L.ImageFilters={},L.ImageFilters.GenerateCSSFilter=function(a){return function(b,c,d){return new L.CSSFilter({filters:a}).render(b,c,d)}},L.ImageFilters.GenerateChannelFilter=function(a){return function(b){return new L.CanvasChannelFilter({filters:a}).render(b)}},L.ImageFilters.GenerateCanvasFilter=function(a){return function(b,c,d){return new L.CanvasFilter({channelFilter:L.ImageFilters.GenerateChannelFilter(a)}).render(b,c,d)}},L.ImageFilters.Presets={CSS:{None:L.ImageFilters.GenerateCSSFilter(["none"]),Brightness200:L.ImageFilters.GenerateCSSFilter(["brightness(200%)"]),Brightness180:L.ImageFilters.GenerateCSSFilter(["brightness(180%)"]),Brightness160:L.ImageFilters.GenerateCSSFilter(["brightness(160%)"]),Brightness140:L.ImageFilters.GenerateCSSFilter(["brightness(140%)"]),Brightness120:L.ImageFilters.GenerateCSSFilter(["brightness(120%)"]),Brightness100:L.ImageFilters.GenerateCSSFilter(["brightness(100%)"]),Brightness80:L.ImageFilters.GenerateCSSFilter(["brightness(80%)"]),Brightness60:L.ImageFilters.GenerateCSSFilter(["brightness(60%)"]),Brightness40:L.ImageFilters.GenerateCSSFilter(["brightness(40%)"]),Brightness20:L.ImageFilters.GenerateCSSFilter(["brightness(20%)"]),Contrast200:L.ImageFilters.GenerateCSSFilter(["contrast(200%)"]),Contrast180:L.ImageFilters.GenerateCSSFilter(["contrast(180%)"]),Contrast160:L.ImageFilters.GenerateCSSFilter(["contrast(160%)"]),Contrast140:L.ImageFilters.GenerateCSSFilter(["contrast(140%)"]),Contrast120:L.ImageFilters.GenerateCSSFilter(["contrast(120%)"]),Contrast100:L.ImageFilters.GenerateCSSFilter(["contrast(100%)"]),Contrast80:L.ImageFilters.GenerateCSSFilter(["contrast(80%)"]),Contrast60:L.ImageFilters.GenerateCSSFilter(["contrast(60%)"]),Contrast40:L.ImageFilters.GenerateCSSFilter(["contrast(40%)"]),Contrast20:L.ImageFilters.GenerateCSSFilter(["contrast(20%)"]),Sepia100:L.ImageFilters.GenerateCSSFilter(["sepia(100%)"]),Sepia80:L.ImageFilters.GenerateCSSFilter(["sepia(80%)"]),Sepia60:L.ImageFilters.GenerateCSSFilter(["sepia(60%)"]),Sepia40:L.ImageFilters.GenerateCSSFilter(["sepia(40%)"]),Sepia20:L.ImageFilters.GenerateCSSFilter(["sepia(20%)"]),Grayscale:L.ImageFilters.GenerateCSSFilter(["saturate(0%)"]),Saturate200:L.ImageFilters.GenerateCSSFilter(["saturate(200%)"]),Saturate300:L.ImageFilters.GenerateCSSFilter(["saturate(300%)"]),Saturate400:L.ImageFilters.GenerateCSSFilter(["saturate(400%)"]),Saturate500:L.ImageFilters.GenerateCSSFilter(["saturate(500%)"]),Saturate600:L.ImageFilters.GenerateCSSFilter(["saturate(600%)"]),Saturate700:L.ImageFilters.GenerateCSSFilter(["saturate(700%)"]),Invert100:L.ImageFilters.GenerateCSSFilter(["invert(100%)"]),Invert80:L.ImageFilters.GenerateCSSFilter(["invert(80%)"]),Invert60:L.ImageFilters.GenerateCSSFilter(["invert(60%)"]),Invert40:L.ImageFilters.GenerateCSSFilter(["invert(40%)"]),Invert20:L.ImageFilters.GenerateCSSFilter(["invert(20%)"]),HueRotate30:L.ImageFilters.GenerateCSSFilter(["hue-rotate(30deg)"]),HueRotate60:L.ImageFilters.GenerateCSSFilter(["hue-rotate(60deg)"]),HueRotate90:L.ImageFilters.GenerateCSSFilter(["hue-rotate(90deg)"]),HueRotate120:L.ImageFilters.GenerateCSSFilter(["hue-rotate(120deg)"]),HueRotate150:L.ImageFilters.GenerateCSSFilter(["hue-rotate(150deg)"]),HueRotate180:L.ImageFilters.GenerateCSSFilter(["hue-rotate(180deg)"]),HueRotate210:L.ImageFilters.GenerateCSSFilter(["hue-rotate(210deg)"]),HueRotate240:L.ImageFilters.GenerateCSSFilter(["hue-rotate(240deg)"]),HueRotate270:L.ImageFilters.GenerateCSSFilter(["hue-rotate(270deg)"]),HueRotate300:L.ImageFilters.GenerateCSSFilter(["hue-rotate(300deg)"]),HueRotate330:L.ImageFilters.GenerateCSSFilter(["hue-rotate(330deg)"])},CanvasChannel:{None:L.ImageFilters.GenerateCanvasFilter([]),Grayscale1:L.ImageFilters.GenerateCanvasFilter([new L.ChannelFilters.Grayscale]),Grayscale2:L.ImageFilters.GenerateCanvasFilter([new L.ChannelFilters.Grayscale({weights:[1,1,1]})]),Grayscale3:L.ImageFilters.GenerateCanvasFilter([new L.ChannelFilters.Grayscale({weights:[1,2,3]})]),Luminance:L.ImageFilters.GenerateCanvasFilter([new L.ChannelFilters.Grayscale({weights:[.2126,.7152,.0722]})]),HueRotate30:L.ImageFilters.GenerateCanvasFilter([new L.ChannelFilters.HSLAdjust({adjustments:[30,0,0]})]),HueRotate60:L.ImageFilters.GenerateCanvasFilter([new L.ChannelFilters.HSLAdjust({adjustments:[60,0,0]})]),HueRotate90:L.ImageFilters.GenerateCanvasFilter([new L.ChannelFilters.HSLAdjust({adjustments:[90,0,0]})]),HueRotate120:L.ImageFilters.GenerateCanvasFilter([new L.ChannelFilters.HSLAdjust({adjustments:[120,0,0]})]),HueRotate150:L.ImageFilters.GenerateCanvasFilter([new L.ChannelFilters.HSLAdjust({adjustments:[150,0,0]})]),HueRotate180:L.ImageFilters.GenerateCanvasFilter([new L.ChannelFilters.HSLAdjust({adjustments:[180,0,0]})]),HueRotate210:L.ImageFilters.GenerateCanvasFilter([new L.ChannelFilters.HSLAdjust({adjustments:[210,0,0]})]),HueRotate240:L.ImageFilters.GenerateCanvasFilter([new L.ChannelFilters.HSLAdjust({adjustments:[240,0,0]})]),HueRotate270:L.ImageFilters.GenerateCanvasFilter([new L.ChannelFilters.HSLAdjust({adjustments:[270,0,0]})]),HueRotate300:L.ImageFilters.GenerateCanvasFilter([new L.ChannelFilters.HSLAdjust({adjustments:[300,0,0]})]),HueRotate330:L.ImageFilters.GenerateCanvasFilter([new L.ChannelFilters.HSLAdjust({adjustments:[330,0,0]})]),Sepia1:L.ImageFilters.GenerateCanvasFilter([new L.ChannelFilters.Sepia]),Invert:L.ImageFilters.GenerateCanvasFilter([new L.ChannelFilters.Invert]),ColorizeRed:L.ImageFilters.GenerateCanvasFilter([new L.ChannelFilters.Colorize({channel:0,values:[0,0]})]),ColorizeGreen:L.ImageFilters.GenerateCanvasFilter([new L.ChannelFilters.Colorize({channel:1,values:[0,0]})]),ColorizeBlue:L.ImageFilters.GenerateCanvasFilter([new L.ChannelFilters.Colorize({channel:2,values:[0,0]})]),Convolve:function(a,b,c){return new L.CanvasFilter({channelFilter:function(a,b){return new L.ConvolveFilter({}).render(a,b)}}).render(a,b,c)},HighContrast:L.ImageFilters.GenerateCanvasFilter([new L.ChannelFilters.Contrast({contrast:128})]),Threshold:L.ImageFilters.GenerateCanvasFilter([new L.ChannelFilters.Threshold]),WaterTransparent:L.ImageFilters.GenerateCanvasFilter([new L.ChannelFilters.ColorSwap({input:{h:[150,210]},output:{h:270,a:.5},nonmatching:function(a){return a.s(0),a}})]),WhiteToNeonBlue:L.ImageFilters.GenerateCanvasFilter([new L.ChannelFilters.ColorSwap({input:{l:[1,1]},output:{r:0,g:255,b:255}})])}},L.ImageFilterFunctions={__loadTile:L.TileLayer.prototype._loadTile,__tileOnLoad:L.TileLayer.prototype._tileOnLoad,__update:L.TileLayer.prototype._update,setFilter:function(a){return this.options.filter=a,this.redraw(),this},setCSSFilter:function(a){return this._cssChanged=!0,this.options.cssFilter=a,this._applyCSSFilter(),this},_applyCSSFilter:function(){this._container&&this._cssChanged&&(this._container.cssText="",this.options.cssFilter&&this.options.cssFilter.call(this,this._container),this._cssChanged=!1)},_update:function(){this.__update.call(this),this._applyCSSFilter()},clearFilter:function(){return this.options.filter=null,this.redraw()},clearCSSFilter:function(){this.setCSSFilter(null)},clearAllFilters:function(){this.options.filter=null,this.options.cssFilter=null,this._cssChanged=!0,this.redraw()},_tileOnLoad:function(a,b){var c=this.options.filter;b.options=this.options,c&&c.call(this,b,b),this.__tileOnLoad.call(this,a,b)}},L.TileLayer.include(L.ImageFilterFunctions),L.TileLayer.addInitHook(function(){this.options.crossOrigin=!0}),L.TileLayer.CanvasTMS=L.TileLayer.extend({options:{tileSize:256,reuseTiles:!0},initialize:function(a,b){L.TileLayer.prototype.initialize.call(this,a,b)},_applyFilter:function(a,b,c,d){L.ImageFilters.Presets.CanvasChannel.None.call(a,a,b,c),setTimeout(this._async(a,b,c,d),0)},_async:function(a,b,c,d){return function(){try{var d=a.options.filter||L.ImageFilters.Presets.CanvasChannel.None;b._layer=a,d.call(a,a,b,c)}finally{!L.Browser.webkit}}},createTile:function(a,b){var c=L.DomUtil.create("canvas","leaflet-tile");c.width=c.height=this.options.tileSize,c.onselectstart=c.onmousemove=L.Util.falseFn;var d=this;c.options=this.options,c._layer=this;var e=c.getContext("2d"),f=1;if(L.Browser.retina&&this.options.detectRetina&&(f=2,c.width=c.height=c.options.tileSize*f,c.style.width=c.style.height=c.options.tileSize+"px"),c._img)c._img.options=d.options,d._applyFilter(c,c._img,e,b);else{var g=new Image;g.onload=function(){b(),c._img=g,c._img.options=d.options,d._applyFilter(c,g,e,b)},g.crossOrigin="anonymous",g.src=d.getTileUrl(a)}return c}});